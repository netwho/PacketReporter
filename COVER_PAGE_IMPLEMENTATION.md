# PacketReporter Cover Page Implementation Guide

**âœ“ IMPLEMENTATION COMPLETED**

All functionality described in this document has been successfully implemented and tested.
The cover page feature is now live in the main codebase.

## Overview
This document describes how to add a cover page with logo, description, and table of contents to PacketReporter detailed reports.

## Files Required

### 1. Configuration Directory
- Location: `~/.packet_reporter/`
- Files:
  - `Logo.png` - Company/custom logo (recommended size: 400x200px)
  - `packet_reporter.txt` - 3-line description text

### 2. Default Files (in project root)
- `Logo.png` - Default PacketReporter logo
- `packet_reporter.txt` - Default description:
  ```
  Customer: netwho
  Segment: Backbone
  Notes: Demo Capture
  ```

## Implementation Steps

### Step 1: Add Configuration Reading Functions

Add to Lua script after utility functions:

```lua
-- Read logo and description from user config
local function read_config_files()
  local home = get_home_dir()
  local config_dir = home .. "/.packet_reporter"
  local logo_path = config_dir .. "/Logo.png"
  local desc_path = config_dir .. "/packet_reporter.txt"
  
  local config = {
    logo_exists = false,
    logo_path = nil,
    description = {}
  }
  
  -- Check if logo exists
  local logo_file = io.open(logo_path, "r")
  if logo_file then
    logo_file:close()
    config.logo_exists = true
    config.logo_path = logo_path
  end
  
  -- Read description file
  local desc_file = io.open(desc_path, "r")
  if desc_file then
    for line in desc_file:lines() do
      table.insert(config.description, line)
    end
    desc_file:close()
  else
    -- Default description
    config.description = {
      "PacketReporter - Network Traffic Analysis Report",
      "Comprehensive analysis of captured network packets",
      "Generated: " .. os.date("%Y-%m-%d %H:%M:%S")
    }
  end
  
  return config
end
```

### Step 2: Generate Cover Page SVG

Add cover page generation function:

```lua
-- Generate cover page with logo, description, and TOC
local function generate_cover_page(paper, config, toc_items)
  local out = {}
  local function add(s) table.insert(out, s) end
  
  add('<?xml version="1.0" encoding="UTF-8"?>\\n')
  add('<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\\n')
  add(string.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="%d" height="%d">\\n', paper.width, paper.height))
  add('<rect x="0" y="0" width="100%" height="100%" fill="white"/>\\n')
  
  -- Logo (if exists) - centered at top
  local y_pos = 100
  if config.logo_exists then
    -- Embed logo as base64 or reference it
    add(string.format('<image x="%d" y="%d" width="400" height="200" xlink:href="file://%s" preserveAspectRatio="xMidYMid meet"/>\\n',
      (paper.width - 400) / 2, y_pos, config.logo_path))
    y_pos = y_pos + 250
  else
    -- Text logo
    add(string.format('<text x="%d" y="%d" text-anchor="middle" font-family="Arial, Helvetica, sans-serif" font-size="48" font-weight="700" fill="#2C7BB6">PacketReporter</text>\\n',
      paper.width / 2, y_pos))
    y_pos = y_pos + 100
  end
  
  -- Description (3 lines, left-aligned)
  for i, line in ipairs(config.description) do
    add(string.format('<text x="100" y="%d" font-family="Arial, Helvetica, sans-serif" font-size="14" fill="#333">%s</text>\\n',
      y_pos + (i-1) * 25, xml_escape(line)))
  end
  y_pos = y_pos + 120
  
  -- Horizontal line separator
  add(string.format('<line x1="80" y1="%d" x2="%d" y2="%d" stroke="#2C7BB6" stroke-width="2"/>\\n',
    y_pos, paper.width - 80, y_pos))
  y_pos = y_pos + 40
  
  -- Table of Contents title
  add(string.format('<text x="100" y="%d" font-family="Arial, Helvetica, sans-serif" font-size="20" font-weight="700" fill="#2C7BB6">Table of Contents</text>\\n',
    y_pos))
  y_pos = y_pos + 40
  
  -- TOC items
  for _, item in ipairs(toc_items) do
    -- Section title (left)
    add(string.format('<text x="120" y="%d" font-family="Arial, Helvetica, sans-serif" font-size="12" fill="#333">%s</text>\\n',
      y_pos, xml_escape(item.title)))
    
    -- Page number (right)
    add(string.format('<text x="%d" y="%d" text-anchor="end" font-family="Arial, Helvetica, sans-serif" font-size="12" fill="#666">%d</text>\\n',
      paper.width - 120, y_pos, item.page))
    
    -- Dotted line
    add(string.format('<line x1="120" y1="%d" x2="%d" y2="%d" stroke="#ddd" stroke-width="1" stroke-dasharray="3,3"/>\\n',
      y_pos - 5, paper.width - 120, y_pos - 5))
    
    y_pos = y_pos + 25
  end
  
  -- Footer
  add(string.format('<text x="%d" y="%d" text-anchor="middle" font-family="Arial, Helvetica, sans-serif" font-size="10" fill="#999">Generated by PacketReporter on %s</text>\\n',
    paper.width / 2, paper.height - 50, os.date("%Y-%m-%d %H:%M:%S")))
  
  add('</svg>\\n')
  return table.concat(out)
end
```

### Step 3: Calculate TOC Page Numbers

Add before generating detailed report:

```lua
local function calculate_toc_pages(paper_height)
  return {
    {title = "1. Summary", page = 2},
    {title = "2. Top 10 IP Addresses", page = 2},
    {title = "3. Protocol Distribution", page = 2},
    {title = "4. IP Communication Matrix", page = 3},
    {title = "5. Port Analysis", page = 4},
    {title = "6. DNS Analysis", page = 5},
    {title = "7. TLS/SSL Analysis", page = 6},
    {title = "8. HTTP Analysis", page = 7},
    {title = "9. MAC Layer Analysis", page = 8},
    {title = "10. IP Layer Analysis", page = 9},
    {title = "11. TCP Analysis", page = 10}
  }
end
```

### Step 4: Update Installer Scripts

#### macOS/Linux (`install.sh`):
```bash
# Create config directory
CONFIG_DIR="$HOME/.packet_reporter"
mkdir -p "$CONFIG_DIR"

# Copy default files if they don't exist
if [ ! -f "$CONFIG_DIR/Logo.png" ]; then
    cp "Logo.png" "$CONFIG_DIR/Logo.png" 2>/dev/null || echo "Logo.png not found, skipping"
fi

if [ ! -f "$CONFIG_DIR/packet_reporter.txt" ]; then
    cat > "$CONFIG_DIR/packet_reporter.txt" << 'EOF'
PacketReporter - Network Traffic Analysis Report
Comprehensive analysis of captured network packets
Generated from Wireshark capture data
EOF
fi

echo "âœ“ Configuration directory created at: $CONFIG_DIR"
echo "  Customize your reports by editing:"
echo "  - $CONFIG_DIR/Logo.png (your company logo)"
echo "  - $CONFIG_DIR/packet_reporter.txt (3-line description)"
```

#### Windows (`install.ps1`):
```powershell
# Create config directory
$ConfigDir = "$env:USERPROFILE\.packet_reporter"
New-Item -ItemType Directory -Force -Path $ConfigDir | Out-Null

# Copy default files if they don't exist
if (!(Test-Path "$ConfigDir\Logo.png")) {
    Copy-Item "Logo.png" "$ConfigDir\Logo.png" -ErrorAction SilentlyContinue
}

if (!(Test-Path "$ConfigDir\packet_reporter.txt")) {
    @"
PacketReporter - Network Traffic Analysis Report
Comprehensive analysis of captured network packets
Generated from Wireshark capture data
"@ | Out-File -FilePath "$ConfigDir\packet_reporter.txt" -Encoding UTF8
}

Write-Host "âœ“ Configuration directory created at: $ConfigDir"
Write-Host "  Customize your reports by editing:"
Write-Host "  - $ConfigDir\Logo.png (your company logo)"
Write-Host "  - $ConfigDir\packet_reporter.txt (3-line description)"
```

## Customization Instructions for README

Add to README.md:

```markdown
## ðŸŽ¨ Customizing Your Reports

PacketReporter allows you to customize the cover page of detailed reports with your own logo and description.

### Configuration Files

Reports can be customized using two files in `~/.packet_reporter/`:

1. **Logo.png** - Your company or custom logo
   - Recommended size: 400x200 pixels
   - Format: PNG with transparency supported
   - Will be centered at the top of the cover page

2. **packet_reporter.txt** - Custom description (3 lines)
   - Line 1: Organization/Customer name
   - Line 2: Network segment or department
   - Line 3: Additional notes or context

### Example Customization

1. **Replace the logo:**
   ```bash
   cp /path/to/your/company-logo.png ~/.packet_reporter/Logo.png
   ```

2. **Edit the description:**
   ```bash
   nano ~/.packet_reporter/packet_reporter.txt
   ```
   
   Example content:
   ```
   Acme Corporation - IT Security Department
   Production Network Segment - Data Center A
   Monthly Security Audit Report - Q4 2024
   ```

3. **Generate a report** - Your customizations will automatically appear on the cover page!

### Cover Page Features

- **Professional Layout**: Clean, corporate design
- **Table of Contents**: Automatic page numbering for all sections
- **Timestamp**: Generation date and time
- **Customizable Branding**: Your logo and description

### Resetting to Defaults

To restore default branding:
```bash
rm ~/.packet_reporter/Logo.png
rm ~/.packet_reporter/packet_reporter.txt
```

The installer will recreate default files on next run.
```

## Notes

- The cover page will be page 1, shifting all content pages by +1
- Logo embedding in SVG works via file:// URI or base64 encoding
- PDF generation will need to handle the cover page as the first page
- Ensure Logo.png has appropriate dimensions (400x200px recommended)
- Description text will be truncated if too long - keep it concise

## Testing

1. Place test logo and description in `~/.packet_reporter/`
2. Generate a detailed report
3. Verify cover page appears as page 1
4. Check table of contents page numbers are accurate
5. Confirm logo displays correctly in PDF export
